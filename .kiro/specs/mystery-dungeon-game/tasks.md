# Implementation Plan

## Overview

不思議のダンジョン系ゲームの実装を、テスト駆動開発とインクリメンタルな進行で行います。各タスクは独立して実装・テスト可能で、段階的に機能を追加していきます。

## Tasks

- [x] 1. プロジェクト基盤とコア設定システムの構築
  - TypeScriptプロジェクトの初期化とビルド環境構築
  - 設定ファイル読み込みシステムの実装
  - コンポーネントシステムの基盤クラス作成
  - _Requirements: 9.1, 9.4, 9.5_

- [x] 2. 基本ゲームエンティティとデータモデルの実装
  - GameEntity基底クラスとPosition型の実装
  - Player、Monster、Companion、Itemの基本モデル作成
  - 基本ステータス（HP、攻撃力、防御力、レベル、経験値）の実装
  - _Requirements: 5.1, 5.2, 3.1, 3.2_

- [x] 3. ダンジョン生成システムの実装
  - 基本的なランダムダンジョン生成アルゴリズム実装
  - 部屋と通路の生成ロジック作成
  - 階段配置システムの実装
  - _Requirements: 1.1, 1.2, 1.3_

- [x] 4. 基本移動システムとターン管理の実装
  - プレイヤーの移動処理実装
  - 基本的なターン順序システム構築
  - キーボード入力処理（矢印キー移動）の実装
  - _Requirements: 2.1, 2.2, 7.1_

- [x] 5. 基本戦闘システムの実装
  - ダメージ計算式の実装（{攻撃力×1.3×(35/36)^防御力}×(7/8~9/8)）
  - 基本攻撃処理とHP減少システム
  - 最小ダメージ保証（1ダメージ）の実装
  - _Requirements: 3.1, 3.2_

- [x] 6. 回避システムとクリティカルヒットの実装
  - 基本回避率（5%）システムの実装
  - クリティカルヒット（5%、防御力無視）システム
  - 回避不能攻撃フラグの実装
  - _Requirements: 3.1, 3.2_

- [x] 7. 属性システムの実装
  - 属性タイプとキャラクター属性の実装
  - 属性相性テーブル（0.8倍、1.0倍、1.2倍）の実装
  - 属性ダメージ修正の戦闘システムへの統合
  - _Requirements: 3.1, 3.2_

- [x] 8. 状態異常システムの実装
  - 毒、混乱、麻痺、拘束の状態異常実装
  - ターン経過による確率的回復システム
  - 状態異常の重複管理システム
  - _Requirements: 3.1, 3.2_

- [x] 9. レベルアップと経験値システムの実装
  - 経験値テーブル（レベル1-100）の実装
  - ステータス成長システム（HP: 1.1倍、攻撃・防御: 1.2倍）
  - 経験値獲得処理（撃破時、アイテム使用時）の実装
  - _Requirements: 5.1, 5.2_

- [x] 10. 満腹度システムの実装
  - 満腹度の減少処理実装
  - 空腹時のダメージシステム
  - 食料アイテムによる回復処理
  - _Requirements: 12.1, 12.2, 12.3, 12.4_

- [x] 11. 基本アイテムシステムの実装
  - アイテムの基本クラスと種類定義
  - インベントリシステムの実装
  - アイテム使用処理の基盤構築
  - _Requirements: 4.1, 4.2, 4.3_

- [x] 12. 装備システムの実装
  - 武器・防具・アクセサリーの装備処理
  - 装備による能力値ボーナスの計算
  - 装備変更時のステータス更新
  - _Requirements: 4.1, 4.2_

- [x] 13. 攻撃コンポーネントシステムの実装
  - 攻撃範囲コンポーネント（隣接、直線、範囲、カスタム）
  - 攻撃回数コンポーネント
  - 攻撃対象コンポーネント（単体、複数、全体）
  - _Requirements: 10.1, 10.2, 10.3, 10.4, 11.1, 11.2, 11.3, 11.4_

- [x] 14. 敵AIと仲間システムの実装
  - 基本的な敵AI行動パターン
  - 仲間の行動システムと指示システム
  - 敵・仲間のレベルアップ処理
  - _Requirements: 15.1, 15.2, 15.3, 15.4_

- [x] 15. 詳細ターンシステムの実装
  - 完全なターン順序システム（プレイヤー→回復→味方移動→敵移動→罠→攻撃）
  - 速度システム（倍速、通常、鈍足）の実装
  - ターン終了処理（状態異常回復、スリップダメージ、満腹度減少）
  - _Requirements: 2.1, 2.2, 2.3_

- [x] 16. 罠システムの実装
  - 罠の配置と発動システム
  - 罠の種類と効果の実装
  - 罠発見システムの実装
  - _Requirements: 14.1, 14.2, 14.3, 14.4_

- [x] 17. 特殊部屋システムの実装
  - モンスターハウス（高密度敵配置）の実装
  - 店システム（アイテム購入）の実装
  - 宝物庫（大量アイテム配置）の実装
  - _Requirements: 17.1, 17.2, 17.3, 17.4_

- [x] 18. 複数ダンジョンシステムの実装
  - ダンジョン定義システムの実装
  - ダンジョン選択とクリア条件の管理
  - ダンジョン解放システムの実装
  - _Requirements: 1.4, 9.1_

- [x] 19. アイテムドロップと出現システムの実装
  - 敵撃破時のドロップシステム
  - フロアアイテムの配置システム
  - ドロップテーブルとレアリティシステム
  - _Requirements: 4.1, 4.2_

- [x] 20. 未鑑定システムの実装
  - アイテムの鑑定状態管理
  - 鑑定方法（使用、巻物、店）の実装
  - ダンジョン別鑑定ルールの実装
  - _Requirements: 16.1, 16.2, 16.3, 16.4_

- [x] 21. 死亡・ゲームオーバーシステムの実装
  - 死亡時のペナルティ処理（アイテム全消失、レベルリセット）
  - ゲームオーバー画面と復帰処理
  - 完全ローグライクシステムの実装
  - _Requirements: 3.3, 5.3_

- [x] 22. UI・表示システムの実装
  - ゲーム画面のレンダリングシステム
  - ステータス表示とメッセージシステム
  - インベントリ画面の実装
  - _Requirements: 6.1, 6.2, 6.3, 7.1, 7.2, 7.3, 7.4_

- [x] 23. 2Dドット絵グラフィックシステムの実装
  - キャラクター・アイテム・地形のスプライト表示
  - アニメーションシステム（移動、攻撃エフェクト）
  - ダンジョンタイプ別のタイルセット対応
  - _Requirements: 8.1, 8.2, 8.3, 8.4_

- [x] 24. 最終統合とバランス調整
  - 全システムの統合テスト
  - ゲームバランスの調整と設定値の最適化
  - パフォーマンス最適化とブラウザ対応確認
  - _Requirements: 7.3, 9.2_